(()=>{"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class t{constructor(t,n,r,i){e(this,"code_product",""),e(this,"name_product",""),e(this,"price_product",""),e(this,"quantity_product",""),this.code_product=t,this.name_product=n,this.price_product=r,this.quantity_product=i}show_item(e){let t=document.createElement("div");t.className="name-product",t.innerHTML=this.name_product,e.appendChild(t);let n=document.createElement("div");n.className="price-product",n.innerHTML=this.price_product,e.appendChild(n);let r=document.createElement("div");r.className="quantity-product",r.innerHTML=this.quantity_product,e.appendChild(r)}get name(){return`${this.name_product}`}get price(){return`${this.price_product}`}get code(){return`${this.code_product}`}get quantity(){return`${this.quantity_product}`}}class n{constructor(e){var t,n;n=[],(t="order_list")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,e&&(this.order_list=new Array(e))}add(e){return new Promise(((n,r)=>{if(void 0===e)r();else{let r=!1;if(this.order_list.forEach((function(t,i,d){t.code==e.code&&(r=t.quantity_product++,n())})),!r){let r=new t(e.code_product,e.name_product,e.price_product,e.quantity_product);this.order_list.push(r),n()}}}))}del(e){return new Promise(((t,n)=>{void 0===e?n():(this.order_list.forEach((function(t,n,r){let i=!0;t.code==e.code&&(i=--t.quantity_product),i||r.splice(n,1)})),t())}))}total_price(){return this.order_list.reduce((function(e,t){return e+t.quantity*t.price}),0)}show_basket(e){if(e.innerHTML="",this.order_list.length){this.show(e);let t=document.createElement("div");t.className="total";let n=this.total_price();t.innerHTML="Общая сумма:  "+n,e.appendChild(t)}else e.innerHTML="Ваша корзина пока пуста"}show(e){this.order_list.forEach((t=>{t.show_item(e);let n=document.createElement("button-plus");n.className="my-btn-buy-plus",n.id=t.code,n.innerHTML="+",e.appendChild(n),n.addEventListener("click",(()=>{this.add(t).then((()=>{this.show_basket(e)}))}));let r=document.createElement("button-minus");r.className="my-btn-buy-minus",r.id=t.code,r.innerHTML=" - ",e.appendChild(r),r.addEventListener("click",(()=>{this.del(t).then((()=>{this.show_basket(e)}))}))}))}load(){var e=this;return new Promise(((n,r)=>{fetch("http://localhost:3000/items.json").then((e=>e.json())).then((r=>{r.forEach(((n,r,i)=>{let d=new t(n.code_product,n.name_product,n.price_product,n.quantity_product);e.order_list.push(d)})),n()}))}))}}const r=document.querySelector(".product"),i=document.querySelector(".order");let d=["Юбка","Брюки","Джемпер","Куртка","Пальто","Свитер","Шорты"],c=["3500","1700","8000","3200","2700"];function o(e){return e[Math.floor(Math.random()*e.length)]}let a=new n,s=new n;s.show_basket(i),a.load().then((()=>{a.order_list.forEach((e=>{let t=document.createElement("div");t.className="name-product",t.innerHTML=e.name,r.appendChild(t);let n=document.createElement("div");n.className="price-product",n.innerHTML=e.price,r.appendChild(n);let d=document.createElement("button");d.className="my-btn-buy",d.id=e.code,d.innerHTML="В корзину",r.appendChild(d),d.addEventListener("click",(function(){s.add(e).then((()=>{s.show_basket(i)}))}))}))}));let l=document.createElement("button");l.className="my-btn-add",l.innerHTML="Отобразить еще товары",r.appendChild(l),l.addEventListener("click",(function(){for(let e=0;e<2;e++){a.add(new t(a.order_list.length+1,o(d),o(c),"1"));let e=a.order_list[a.order_list.length-1],n=document.createElement("div");n.className="name-product",n.innerHTML=e.name_product,r.appendChild(n);let l=document.createElement("div");l.className="price-product",l.innerHTML=e.price_product,r.appendChild(l);let u=document.createElement("button");u.className="my-btn-buy",u.id=e.code_product,u.innerHTML="В корзину",r.appendChild(u),u.addEventListener("click",(function(){s.add(e).then((()=>{s.show_basket(i)}))}))}a.order_list.length>12&&(l.style.display="none")}))})();